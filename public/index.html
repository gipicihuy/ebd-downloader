<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eberardos - TikTok Downloader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="https://eberardos.my.id/eberardos.jpg" type="image/jpeg">
    <meta property="og:title" content="Eberardos - TikTok Downloader">
    <meta property="og:description" content="Download TikTok videos without watermark for free.">
    <meta property="og:image" content="https://eberardos.my.id/eberardos.jpg">
    <meta property="og:url" content="https://eberardos.my.id/tiktok-downloader">
    <meta property="og:type" content="website">
    <link href="https://fonts.cdnfonts.com/css/conthrax" rel="stylesheet">
    <script>
        // TailwindCSS configuration with adjusted dark-red colors
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        'dark-red': {
                            500: '#8B0000',
                            600: '#7A0000',
                            700: '#690000',
                            800: '#580000',
                            // Changed to a brighter color for better visibility
                            900: '#470000', 
                            '900-dark': '#310000'
                        },
                        'dark-gray': {
                            'body': '#1a202c',
                            'card': '#2d3748',
                            'text': '#e2e8f0',
                            'line': '#4a5568'
                        }
                    },
                    fontFamily: {
                        'poppins': ['Poppins', 'sans-serif'],
                        'conthrax': ['Conthrax', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style type="text/css">
        html {
            scroll-behavior: smooth;
        }
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        main {
            flex-grow: 1;
        }
        .animated-section {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .animated-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="font-poppins bg-gray-50 text-gray-800 transition-colors duration-500 dark:bg-dark-gray-body dark:text-dark-gray-text">

    <main>
        <section id="downloader-section" class="py-16 bg-white dark:bg-dark-gray-body animated-section is-visible">
            <div class="max-w-xl mx-auto px-4 sm:px-6 lg:px-8 text-center bg-gray-100 dark:bg-dark-gray-card p-8 rounded-lg shadow-lg border border-gray-200 dark:border-dark-gray-line transition-colors duration-500">
                <h2 class="text-3xl md:text-4xl font-bold text-dark-red-700 mb-6 font-conthrax transition-colors duration-500 dark:text-dark-red-500">
                    TikTok Downloader
                </h2>
                <p class="text-lg text-gray-700 mb-8 transition-colors duration-500 dark:text-dark-gray-text">
                    Tempel URL video TikTok di sini untuk mengunduh tanpa watermark.
                </p>
                <input type="text" id="tiktokUrl" placeholder="Contoh: https://vt.tiktok.com/..." required
                       class="w-full px-4 py-3 rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-dark-red-500 bg-white dark:bg-dark-gray-body dark:text-dark-gray-text transition-colors duration-500">
                <button id="downloadBtn"
                        class="w-full mt-4 px-6 py-3 bg-dark-red-600 text-white font-semibold rounded-md hover:bg-dark-red-700 transition-colors duration-300 transform hover:scale-105 dark:bg-dark-red-500 dark:hover:bg-dark-red-600">
                    Download
                </button>
                <div id="loading" class="mt-6 text-dark-red-500 font-medium hidden">Memproses...</div>
                <div id="result" class="mt-6"></div>
            </div>
        </section>
    </main>

    <footer class="bg-dark-red-900 text-white py-8 transition-colors duration-500 dark:bg-dark-red-900-dark">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <p>Â© 2021 - 2025 Eberardos Community</p>
        </div>
    </footer>
    
    <script>
        // Downloader script logic
        document.getElementById('downloadBtn').addEventListener('click', async () => {
            const urlInput = document.getElementById('tiktokUrl');
            const url = urlInput.value.trim();
            const resultDiv = document.getElementById('result');
            const loadingDiv = document.getElementById('loading');

            if (!url) {
                resultDiv.innerHTML = '<p class="text-red-500">URL tidak boleh kosong!</p>';
                return;
            }

            loadingDiv.classList.remove('hidden');
            resultDiv.innerHTML = '';

            try {
                const response = await fetch('/api/download-tiktok', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ url })
                });

                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    resultDiv.innerHTML = `<p class="text-red-500">Kesalahan server: ${errorData.error || response.statusText}</p>`;
                    return;
                }

                const data = await response.json();
                
                if (data.status === true && data.data && data.data.urls && data.data.urls.length > 0) {
                    const downloadUrl = data.data.urls[0];
                    const metadata = data.data.metadata;
                    const originalUrl = data.data.original_url || '#';
                    const thumbnail = metadata.thumbnail || 'https://via.placeholder.com/200';
                    const title = metadata.title || 'Tidak Ada Judul';
                    const creator = metadata.creator || 'Tidak Diketahui';
                    const description = metadata.description || 'Tidak Ada Deskripsi';

                    resultDiv.innerHTML = `
                        <div class="bg-gray-50 dark:bg-dark-gray-body p-6 rounded-lg shadow-md border border-gray-200 dark:border-dark-gray-line transition-colors duration-500">
                            <p class="text-green-500 mb-4 font-semibold">Video berhasil diunduh!</p>
                            <div class="text-center mb-6">
                                <img src="${thumbnail}" alt="Video Thumbnail" class="w-48 h-auto mx-auto mb-4 rounded-lg shadow-md">
                                <p class="text-sm"><strong>Judul:</strong> ${title}</p>
                                <p class="text-sm"><strong>Dibuat oleh:</strong> ${creator}</p>
                                <p class="text-sm"><strong>Deskripsi:</strong> ${description}</p>
                                <p class="text-sm"><strong>URL Asli:</strong> <a href="${originalUrl}" target="_blank" class="text-blue-500 hover:underline break-all">${originalUrl}</a></p>
                            </div>
                            <a href="${downloadUrl}" class="w-full inline-block px-6 py-3 bg-dark-red-600 text-white font-semibold rounded-md hover:bg-dark-red-700 transition-colors duration-300 dark:bg-dark-red-500 dark:hover:bg-dark-red-600">
                                Unduh Video Sekarang
                            </a>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `<p class="text-red-500">${data.message || data.error || 'Gagal mengunduh video. Coba URL lain.'}</p>`;
                }

            } catch (error) {
                console.error("Fetch error:", error);
                resultDiv.innerHTML = '<p class="text-red-500">Terjadi kesalahan tak terduga. Periksa koneksi internet Anda.</p>';
            } finally {
                loadingDiv.classList.add('hidden');
            }
        });
    </script>
</body>
</html>
